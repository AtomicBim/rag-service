name: rag-service
services:
  qdrant:
    container_name: rag_qdrant
    image: qdrant/qdrant:latest
    networks:
      default: null
    ports:
      - mode: ingress
        target: 6333
        published: "6333"
        protocol: tcp
    restart: unless-stopped
    volumes:
      - type: bind
        source: C:\Users\AI-agent\Desktop\GitHub\rag-service\qdrant_data
        target: /qdrant/storage
        bind:
          create_host_path: true
  rag-bot:
    build:
      context: C:\Users\AI-agent\Desktop\GitHub\rag-service\rag-bot
      dockerfile: Dockerfile
    container_name: rag_bot_service
    depends_on:
      qdrant:
        condition: service_started
        required: true
    environment:
      DOCS_DIR: ./data
      LLM_TEMPERATURE: "0.3"
      OPENROUTER_API_KEY: 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
      OPENROUTER_EMBEDDING_MODEL: cohere/embed-multilingual-v3.0
      OPENROUTER_MODEL: cohere/command-r-08-2024
      PYTHONUNBUFFERED: "1"
      QDRANT_COLLECTION_NAME: internal_regulations_v2
      QDRANT_HOST: qdrant
      QDRANT_PORT: "6333"
      RAG_BOT_ENDPOINT: http://rag-bot:8000/generate_answer
      SEARCH_LIMIT: "30"
      YANDEX_BOT_TOKEN: y0__xDtxcK5CBiWkRMgu66iyhS-JFFbtzxzSwfWEznWmNZcDva_Kw
    networks:
      default: null
    ports:
      - mode: ingress
        target: 8000
        published: "8000"
        protocol: tcp
    restart: unless-stopped
  rag-chat:
    build:
      context: C:\Users\AI-agent\Desktop\GitHub\rag-service\rag-chat
      dockerfile: Dockerfile
    container_name: rag_chat_service
    depends_on:
      qdrant:
        condition: service_started
        required: true
      rag-bot:
        condition: service_started
        required: true
    environment:
      DOCS_DIR: ./data
      LLM_TEMPERATURE: "0.3"
      OPENROUTER_API_KEY: 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
      OPENROUTER_EMBEDDING_MODEL: cohere/embed-multilingual-v3.0
      OPENROUTER_MODEL: cohere/command-r-08-2024
      PYTHONUNBUFFERED: "1"
      QDRANT_COLLECTION_NAME: internal_regulations_v2
      QDRANT_HOST: qdrant
      QDRANT_PORT: "6333"
      RAG_BOT_ENDPOINT: http://rag-bot:8000/generate_answer
      SEARCH_LIMIT: "30"
      YANDEX_BOT_TOKEN: y0__xDtxcK5CBiWkRMgu66iyhS-JFFbtzxzSwfWEznWmNZcDva_Kw
    networks:
      default: null
    ports:
      - mode: ingress
        target: 7860
        published: "7860"
        protocol: tcp
    restart: unless-stopped
  rag-yandex-bot:
    build:
      context: C:\Users\AI-agent\Desktop\GitHub\rag-service\rag-yandex-bot
      dockerfile: Dockerfile
    container_name: rag_yandex_bot_service
    depends_on:
      qdrant:
        condition: service_started
        required: true
      rag-bot:
        condition: service_started
        required: true
    environment:
      DOCS_DIR: ./data
      LLM_TEMPERATURE: "0.3"
      OPENROUTER_API_KEY: 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
      OPENROUTER_EMBEDDING_MODEL: cohere/embed-multilingual-v3.0
      OPENROUTER_MODEL: cohere/command-r-08-2024
      PYTHONUNBUFFERED: "1"
      QDRANT_COLLECTION_NAME: internal_regulations_v2
      QDRANT_HOST: qdrant
      QDRANT_PORT: "6333"
      RAG_BOT_ENDPOINT: http://rag-bot:8000/generate_answer
      SEARCH_LIMIT: "30"
      YANDEX_BOT_TOKEN: y0__xDtxcK5CBiWkRMgu66iyhS-JFFbtzxzSwfWEznWmNZcDva_Kw
    networks:
      default: null
    restart: unless-stopped
networks:
  default:
    name: rag-service_default
